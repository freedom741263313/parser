# UDP协议解析器 - 原型交互文档 (Prototype Design)

## 1. 设计概述

本文档描述了"跨平台桌面UDP协议解析器"的用户界面(UI)设计和交互流程(UX)。基于PRD v1.1文档，旨在提供直观、高效的操作体验。

### 1.1 核心设计理念
- **左侧导航，右侧内容**：采用经典的侧边栏导航布局，确保各功能模块切换便捷。
- **分屏视图**：在解析和调试界面，采用左右分屏，左侧为输入，右侧为解析结果，便于对照。
- **全中文界面**：所有界面元素、提示信息均为中文。

## 2. 界面导航结构

应用主要分为四个主功能模块，通过左侧侧边栏图标/文字进行切换：

1.  **解析器 (Parser)**：核心功能，静态数据的输入、解析和码流生成。
2.  **UDP调试 (UDP Debugger)**：动态功能，UDP发送、接收、监听和自动响应。
3.  **规则管理 (Rule Manager)**：协议规则的增删改查。
4.  **枚举管理 (Enum Manager)**：枚举字典的维护。

---

## 3. 界面详细设计

### 3.1 解析器 (Parser) 界面

**布局**：
- **顶部工具栏**：
    - **协议选择器**：下拉框，选择当前使用的协议规则。
        - **内置/演示**：例如 `演示协议`, `STUN (RFC 5389)`, `SIP (RFC 3261)`。
        - **自定义规则**：列出用户创建的规则。
    - **加载示例**：文字按钮，点击后触发加载或生成示例的流程。

- **主内容区**（左右分屏，高度对齐）：
    - **左侧（输入区）**：
        - **标题栏**：
            - 标题："输入"
            - **工具栏按钮**：
                - `[复制]`：图标按钮，复制内容到剪贴板。
                - `[保存]`：图标按钮（仅自定义规则显示），弹出确认框将内容保存为该规则的默认示例。
                - `[格式化]`：文字/图标按钮，手动格式化Hex。
                - `[清空]`：图标按钮，清空内容。
        - **文本框**：
            - 多行文本框，支持HexDump格式输入。
            - 占位符提示中文。
        - **底部按钮**：`[解析]`（带图标）。
        - **错误提示**：显示在文本框下方。

    - **右侧（结果区）**：
        - **标题栏**：
            - 标题："解析结果"（与输入区标题栏高度一致）。
        - **内容展示**：
            - **表格/树状视图**：显示解析后的结构化数据。
            - 显示 `[字段名]`, `[原始Hex]`, `[解析值/枚举含义]`。
            - 支持展开/折叠嵌套结构。
            - 空状态提示："等待解析..."。

**交互流程 - 样本生成**：
1.  用户点击`[加载示例]`。
2.  如果该规则无预设样本，或用户选择"生成新示例"，弹出**样本生成弹窗**。
3.  **弹窗内容**：
    - 根据规则字段动态生成的表单。
    - 数字字段：聚焦时自动全选默认值（0），方便直接输入。
    - 枚举字段：下拉选择。
4.  点击`[生成并保存]`。
5.  系统生成Hex字符串，填入输入框，并自动保存为该规则的示例。

### 3.2 UDP调试 (UDP Debugger) 界面

**布局**：
- **左侧栏（配置与列表）**：
    - **连接配置**：
        - 本地监听端口输入框。
        - 目标IP & 端口输入框。
        - 按钮：`[开始监听] / [停止]`。
    - **消息列表**：
        - 列表项：`[时间] [方向(发送/接收)] [长度] [源IP:Port]`。
        - 点击某一项，右侧显示详情。
- **右侧栏（详情与操作）**：
    - **顶部页签**：`[消息详情] | [发送/响应配置]`。
    - **消息详情页**：
        - 显示选中消息的HexDump。
        - 显示基于当前规则的解析结果。
    - **发送/响应配置页**：
        - **手动发送**：输入Hex或使用生成器，点击`[发送]`。
        - **自动响应规则**：
            - 列表显示当前响应逻辑。
            - `[添加响应]` 按钮，弹出配置框。

### 3.3 规则管理 (Rule Manager) 界面

**布局**：
- **左侧**：规则列表（搜索框 + 列表）。底部有 `[新建规则]` `[导入]` `[导出]` 按钮。
- **右侧**：规则编辑器。
    - **基本信息**：规则名称、描述。
    - **字段定义表格**：
        - 列：`字段名`、`偏移(Auto/Fixed)`、`长度`、`类型`、`端序`、`解析算法`、`关联枚举`、`操作`。

### 3.4 枚举管理 (Enum Manager) 界面

**布局**：
- **左侧**：枚举字典列表。
- **右侧**：字典详情编辑。
    - 表格：`Hex值` | `中文描述` | `备注`。

---

## 4. 关键交互细节

### 4.1 输入体验
- **复制/粘贴**：支持一键复制输入内容。
- **保存示例**：防止误操作，保存覆盖示例时需弹窗确认。
- **格式化**：提供手动格式化功能，保持输入整洁。

### 4.2 错误处理
- **解析错误**：在输入区下方显示具体的错误信息。

## 5. 视觉风格
- **主题**：支持 深色/浅色 (Dark/Light) 模式。
- **对齐**：严格保证左右分屏的标题栏、内容区高度对齐，提供整洁的视觉体验。
- **字体**：Hex数据使用等宽字体。
